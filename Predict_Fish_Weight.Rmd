---
title: "Weight of Fish"
author: "Chi Nguyen"
date: "`r Sys.Date()`"  
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5

 
    
---


```{r include=FALSE,echo=FALSE}
require(tigerstats)
require(tidyverse)
require(car)
require(leaps)
Fish <- read.csv(file="Fish.csv")
```








# Predicting Fish Weight

```{r}
Fish <- Fish %>%

mutate(across(where(is.character), as.factor))

levels(Fish$Species)
```



```{r}
Bream <- filter(Fish, Species == "Bream")

Bream <- select(Bream, -Species) 

Parkki <- filter(Fish, Species == "Parkki")

Parkki <- select(Parkki, -Species) 

Perch <- filter(Fish, Species == "Perch")

Perch <- select(Perch, -Species) 

Pike <- filter(Fish, Species == "Pike")

Pike <- select(Pike, -Species)

Roach <- filter(Fish, Species == "Roach")

Roach <- select(Roach, -Species) 

Smelt <- filter(Fish, Species == "Smelt")

Smelt <- select(Smelt, -Species) 

Whitefish <- filter(Fish, Species == "Whitefish")

Whitefish <- select(Whitefish, -Species) 
```


## Perch

```{r}
regsubsets.out <-

    regsubsets(Weight ~ .,

               data = Perch,

               nbest = 

1,       

# 1 best model for each number of predictors

               nvmax = 

NULL,    

# NULL for no limit on number of variables

               force.in = 

NULL, force.out = 

NULL,

               method = 

"exhaustive")

summary.out <- summary(regsubsets.out)

as.data.frame(summary.out$outmat)


```

```{r}
library(leaps)

regsubsets.out <-

    regsubsets(Weight ~ .,

               data = Perch,

               nbest = 1,       # 1 best model for each number of predictors

               nvmax = NULL,    # NULL for no limit on number of variables

               force.in = NULL, force.out = NULL,

               method = "exhaustive")

 

summary.out <- summary(regsubsets.out)

as.data.frame(summary.out$outmat)

library(car)

subsets(regsubsets.out,statistic="adjr2",legend="topright",main="Adjusted R^2")


```

Perch model 

```{r}
Perchmodel <- lm(Weight ~Height+Width, data=Perch)
summary.lm(Perchmodel)
```


The best model based on this graph is the Perch model. The two element model in Perch in the best, the two regression model, Height and Width.


### Best Models

The best models are the two element models of Height and Width.

### Best Two regressor model

The best two regressor models are also Height and Width

## Pike

```{r}
library(leaps)

regsubsets.out <-

    regsubsets(Weight ~ .,

               data = Pike,

               nbest = 1,       # 1 best model for each number of predictors

               nvmax = NULL,    # NULL for no limit on number of variables

               force.in = NULL, force.out = NULL,

               method = "exhaustive")

 

summary.out <- summary(regsubsets.out)

as.data.frame(summary.out$outmat)

library(car)

subsets(regsubsets.out,statistic="adjr2",legend="topright",main="Adjusted R^2")


```

### Best Models

The best model is a five element answer. The Adjusted R squared shows us that all five componensts, length 1,2,3 Height, and Width are placed in the top right of the model above. 

### Best Two regressor model

Based on the leaps data, Length 1 and Length3 are the best two regressor model.

## Roach

```{r}
library(leaps)

regsubsets.out <-

    regsubsets(Weight ~ .,

               data = Roach,

               nbest = 1,       # 1 best model for each number of predictors

               nvmax = NULL,    # NULL for no limit on number of variables

               force.in = NULL, force.out = NULL,

               method = "exhaustive")

 

summary.out <- summary(regsubsets.out)

as.data.frame(summary.out$outmat)

library(car)

subsets(regsubsets.out,statistic="adjr2",legend="topright",main="Adjusted R^2")


```

### Best Models

The best overall model for the Roach model is similar to the Perch results. This graph shows that length 1, 3 and Width have the best Adjusted R squared data.

### Best Two regressor model

The two best regressor models are the Length 3 and Width models as well.

## Final Summary Statements


